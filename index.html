<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šåˆçº¦ä¸€ä½“åŒ–ç®¡ç†é¢æ¿ï¼ˆé¢„è®¾åœ°å€ï¼‰</title>
    <!-- Bootstrap æ ·å¼ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Ethers.js -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        /* é€šç”¨æ ·å¼ */
        body {
            background-color: #f5f7fa;
            padding-bottom: 50px;
        }
        .container {
            max-width: 1200px;
        }
        .header-bar {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }
        .contract-card {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 25px;
            margin-bottom: 30px;
        }
        .contract-card h4 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-label {
            font-weight: 600;
            color: #34495e;
        }
        .btn-custom {
            background-color: #3498db;
            color: #fff;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        .btn-custom:hover {
            background-color: #2980b9;
            color: #fff;
        }
        .btn-custom:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .btn-read {
            background-color: #2ecc71;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin-left: 10px;
            transition: all 0.3s;
        }
        .btn-read:hover {
            background-color: #27ae60;
            color: #fff;
        }
        .btn-unlock {
            font-size: 0.8em;
            color: #999;
            cursor: pointer;
            margin-left: 5px;
        }
        .btn-unlock:hover {
            color: #3498db;
        }
        /* çŠ¶æ€æç¤º */
        .status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 5px;
            display: none;
        }
        .status.loading {
            display: block;
            background-color: #fff3cd;
            color: #856404;
        }
        .status.success {
            display: block;
            background-color: #d4edda;
            color: #155724;
        }
        .status.error {
            display: block;
            background-color: #f8d7da;
            color: #721c24;
        }
        /* æŠ˜å é¢æ¿ */
        .collapse-btn {
            background: none;
            border: none;
            color: #3498db;
            font-size: 0.9em;
            cursor: pointer;
        }
        .collapse-content {
            margin-top: 15px;
        }
        /* åœ°å€/æ•°å€¼æ ¡éªŒ */
        .is-invalid {
            border-color: #dc3545 !important;
        }
        .invalid-feedback {
            display: block;
            color: #dc3545;
            font-size: 0.85em;
            margin-top: 5px;
        }
        /* åªè¯»æ ·å¼ */
        .addr-input[readonly] {
            background-color: #f8f9fa;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <!-- å¤´éƒ¨ï¼šé’±åŒ…è¿æ¥ + åˆçº¦åœ°å€é…ç½® -->
        <div class="header-bar">
            <div class="row align-items-center">
                <div class="col-md-4 mb-3 mb-md-0">
                    <h3>å¤šåˆçº¦ç®¡ç†é¢æ¿ï¼ˆé¢„è®¾åœ°å€ï¼‰</h3>
                </div>
                <div class="col-md-8">
                    <!-- é’±åŒ…è¿æ¥ -->
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <button id="connectWallet" class="btn-custom w-100">è¿æ¥é’±åŒ…</button>
                            <div id="walletStatus" class="mt-2 text-muted">æœªè¿æ¥é’±åŒ…</div>
                        </div>
                        <div class="col-md-6">
                            <select id="chainSelector" class="form-control">
                                <option value="56">BSC ä¸»ç½‘ (56)</option>
                                <option value="97">BSC æµ‹è¯•ç½‘ (97)</option>
                                <option value="1">ä»¥å¤ªåŠä¸»ç½‘ (1)</option>
                                <option value="5">ä»¥å¤ªåŠæµ‹è¯•ç½‘ Goerli (5)</option>
                            </select>
                        </div>
                    </div>

                    <!-- å„åˆçº¦åœ°å€é…ç½®ï¼ˆé¢„è®¾åœ°å€ï¼‰ -->
                    <div class="row">
                        <div class="col-md-3 mb-2">
                            <label class="form-label">OneClickLP åœ°å€
                                <span class="btn-unlock" onclick="unlockInput('oneClickLPAddr')">ğŸ”“ è§£é”</span>
                            </label>
                            <input type="text" id="oneClickLPAddr" class="form-control addr-input" 
                                value="0x903C5C02AB43804aa8f55624A4e464D50eC2e50a" readonly placeholder="0x...">
                        </div>
                        <div class="col-md-3 mb-2">
                            <label class="form-label">ReleaseController åœ°å€
                                <span class="btn-unlock" onclick="unlockInput('releaseControllerAddr')">ğŸ”“ è§£é”</span>
                            </label>
                            <input type="text" id="releaseControllerAddr" class="form-control addr-input" 
                                value="0x427817aCF26F2A3641D9BFB746d8b094999290f3" readonly placeholder="0x...">
                        </div>
                        <div class="col-md-3 mb-2">
                            <label class="form-label">LPRewardBurn åœ°å€
                                <span class="btn-unlock" onclick="unlockInput('lpRewardBurnAddr')">ğŸ”“ è§£é”</span>
                            </label>
                            <input type="text" id="lpRewardBurnAddr" class="form-control addr-input" 
                                value="0x3Bf12a0C5215F0e3F306545176933c88D342b6D7" readonly placeholder="0x...">
                        </div>
                        <div class="col-md-3 mb-2">
                            <label class="form-label">LPFarm åœ°å€
                                <span class="btn-unlock" onclick="unlockInput('lpFarmAddr')">ğŸ”“ è§£é”</span>
                            </label>
                            <input type="text" id="lpFarmAddr" class="form-control addr-input" 
                                value="0x36e222C65868Ec847feCFd4A5f39f220319e478F" readonly placeholder="0x...">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 1. OneClickLP åˆçº¦ç®¡ç† -->
        <div class="contract-card">
            <div class="d-flex justify-content-between align-items-center">
                <h4>OneClickLP åˆçº¦é…ç½®</h4>
                <button class="collapse-btn" onclick="toggleCollapse('oneClickLPCollapse')">æ”¶èµ· â–²</button>
            </div>
            <div id="oneClickLPCollapse" class="collapse-content">
                <!-- setRouter -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>1. è®¾ç½® Router åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPRouter" class="form-control" placeholder="UniswapV2 Router åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setRouter')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('router')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPRouterStatus" class="status"></div>
                    </div>
                </div>

                <!-- setFactory -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>2. è®¾ç½® Factory åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPFactory" class="form-control" placeholder="UniswapV2 Factory åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setFactory')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('factory')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPFactoryStatus" class="status"></div>
                    </div>
                </div>

                <!-- setUsdt -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>3. è®¾ç½® USDT åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPUsdt" class="form-control" placeholder="USDT åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setUsdt')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('usdt')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPUsdtStatus" class="status"></div>
                    </div>
                </div>

                <!-- setAMMAddress -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>4. è®¾ç½® AMM åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPAMM" class="form-control" placeholder="AMM åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setAMMAddress')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('ammAddress')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPAMMStatus" class="status"></div>
                    </div>
                </div>

                <!-- setFarm -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>5. è®¾ç½® Farm åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPFarm" class="form-control" placeholder="LPFarm åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setFarm')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('farm')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPFarmStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMinibtc -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>6. è®¾ç½® MiniBTC åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPMinibtc" class="form-control" placeholder="MiniBTC åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setMinibtc')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('minibtc')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPMinibtcStatus" class="status"></div>
                    </div>
                </div>

                <!-- setSellFeeBps -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>7. è®¾ç½®é”€å”®æ‰‹ç»­è´¹ (BPS)</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="number" id="oneClickLPSellFeeBps" class="form-control" placeholder="0-10000" min="0" max="10000">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setSellFeeBps')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('sellFeeBps')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPSellFeeBpsStatus" class="status"></div>
                    </div>
                </div>

                <!-- setReleaseController -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>8. è®¾ç½® ReleaseController åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="oneClickLPReleaseController" class="form-control" placeholder="ReleaseController åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setReleaseController')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readOneClickLPConfig('ReleaseController')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPReleaseControllerStatus" class="status"></div>
                    </div>
                </div>

                <!-- setLPCreateWay -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>9. è®¾ç½® LP åˆ›å»ºæ–¹å¼</h6>
                        <div class="row mb-2 align-items-end">
                            <div class="col-md-2">
                                <label class="form-label">å¯ç”¨ MiniBTC åˆ›å»º</label>
                                <input type="checkbox" id="lpWayMinibtc" checked>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">å¯ç”¨ MiniBTC+USDT åˆ›å»º</label>
                                <input type="checkbox" id="lpWayMinibtcUsdt" checked>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">å¯ç”¨ USDT åˆ›å»º</label>
                                <input type="checkbox" id="lpWayUsdt" checked>
                            </div>
                            <div class="col-md-3">
                                <button onclick="callOneClickLPFunction('setLPCreateWay')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-3">
                                <button onclick="readOneClickLPConfig('lpCreateWay')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="oneClickLPLPCreateWayStatus" class="status"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. ReleaseController åˆçº¦ç®¡ç† -->
        <div class="contract-card">
            <div class="d-flex justify-content-between align-items-center">
                <h4>ReleaseController åˆçº¦é…ç½®</h4>
                <button class="collapse-btn" onclick="toggleCollapse('releaseControllerCollapse')">æ”¶èµ· â–²</button>
            </div>
            <div id="releaseControllerCollapse" class="collapse-content">
                <!-- setUsdtToken -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>1. è®¾ç½® USDT ä»£å¸åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="rcUsdtToken" class="form-control" placeholder="USDT åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setUsdtToken')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('usdtToken')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcUsdtTokenStatus" class="status"></div>
                    </div>
                </div>

                <!-- setFeeEOA -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>2. è®¾ç½®æ‰‹ç»­è´¹æ¥æ”¶åœ°å€ (EOA)</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="rcFeeEOA" class="form-control" placeholder="æ¥æ”¶æ‰‹ç»­è´¹çš„ EOA åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setFeeEOA')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('feeEOA')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcFeeEOAStatus" class="status"></div>
                    </div>
                </div>

                <!-- setFarmContract -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>3. è®¾ç½® Farm åˆçº¦åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="rcFarmContract" class="form-control" placeholder="LPFarm åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setFarmContract')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('farmContract')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcFarmContractStatus" class="status"></div>
                    </div>
                </div>

                <!-- setTransferAdmin -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>4. è®¾ç½®è½¬è´¦ç®¡ç†å‘˜åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="rcTransferAdmin" class="form-control" placeholder="ç®¡ç†å‘˜åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setTransferAdmin')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('transferAdmin')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcTransferAdminStatus" class="status"></div>
                    </div>
                </div>

                <!-- toggleTransferPerm -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>5. åˆ‡æ¢è½¬è´¦æƒé™</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <select id="rcTransferPerm" class="form-control">
                                    <option value="true">å¯ç”¨</option>
                                    <option value="false">ç¦ç”¨</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('toggleTransferPerm')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('transferPerm')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcTransferPermStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMinibtcConfig -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>6. è®¾ç½® MiniBTC é…ç½®</h6>
                        <div class="row mb-2 align-items-end">
                            <div class="col-md-3">
                                <input type="text" id="rcMinibtc" class="form-control" placeholder="MiniBTC åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="rcMinibtcPair" class="form-control" placeholder="MiniBTC äº¤æ˜“å¯¹åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setMinibtcConfig')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-3">
                                <button onclick="readReleaseControllerConfig('minibtcConfig')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcMinibtcConfigStatus" class="status"></div>
                    </div>
                </div>

                <!-- setRewardSigner -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>7. è®¾ç½®å¥–åŠ±ç­¾åè€…åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="rcRewardSigner" class="form-control" placeholder="ç­¾åè€…åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setRewardSigner')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('rewardSigner')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcRewardSignerStatus" class="status"></div>
                    </div>
                </div>

                <!-- setFireflyNFT -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>8. è®¾ç½® FireflyNFT åˆçº¦åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="rcFireflyNFT" class="form-control" placeholder="NFT åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callReleaseControllerFunction('setFireflyNFT')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readReleaseControllerConfig('fireflyNFT')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="rcFireflyNFTStatus" class="status"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 3. LPRewardBurn åˆçº¦ç®¡ç† -->
        <div class="contract-card">
            <div class="d-flex justify-content-between align-items-center">
                <h4>LPRewardBurn åˆçº¦é…ç½®</h4>
                <button class="collapse-btn" onclick="toggleCollapse('lpRewardBurnCollapse')">æ”¶èµ· â–²</button>
            </div>
            <div id="lpRewardBurnCollapse" class="collapse-content">
                <!-- setToken -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>1. è®¾ç½®å¥–åŠ±ä»£å¸åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lrbToken" class="form-control" placeholder="ä»£å¸åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPRewardBurnFunction('setToken')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPRewardBurnConfig('token')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lrbTokenStatus" class="status"></div>
                    </div>
                </div>

                <!-- setRewardSigner -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>2. è®¾ç½®å¥–åŠ±ç­¾åè€…åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lrbRewardSigner" class="form-control" placeholder="ç­¾åè€…åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPRewardBurnFunction('setRewardSigner')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPRewardBurnConfig('rewardSigner')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lrbRewardSignerStatus" class="status"></div>
                    </div>
                </div>

                <!-- setBurnBlackHole -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>3. è®¾ç½®é”€æ¯é»‘æ´åœ°å€</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lrbBurnBlackHole" class="form-control" placeholder="é»‘æ´åœ°å€ï¼ˆé»˜è®¤0x000000000000000000000000000000000000dEaDï¼‰">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPRewardBurnFunction('setBurnBlackHole')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPRewardBurnConfig('burnBlackHole')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lrbBurnBlackHoleStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMaxBurnPerDay -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>4. è®¾ç½®æ¯æ—¥æœ€å¤§é”€æ¯é‡</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="number" id="lrbMaxBurnPerDay" class="form-control" placeholder="æœ€å¤§é”€æ¯é‡ï¼ˆæœ€å°å•ä½ï¼‰" min="0">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPRewardBurnFunction('setMaxBurnPerDay')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPRewardBurnConfig('maxBurnPerDay')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lrbMaxBurnPerDayStatus" class="status"></div>
                    </div>
                </div>

                <!-- BurnMiniBtc -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>5. æ‰§è¡Œ MiniBTC é”€æ¯</h6>
                        <div class="row mb-2 align-items-end">
                            <div class="col-md-3">
                                <input type="number" id="lrbBurnAmount" class="form-control" placeholder="é”€æ¯æ•°é‡ï¼ˆæœ€å°å•ä½ï¼‰" min="1">
                            </div>
                            <div class="col-md-3">
                                <input type="text" id="lrbBurnDate" class="form-control" placeholder="é”€æ¯æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPRewardBurnFunction('BurnMiniBtc')" class="btn-custom w-100">æ‰§è¡Œé”€æ¯</button>
                            </div>
                            <div class="col-md-3">
                                <button onclick="readLPRewardBurnConfig('lastBurnInfo')" class="btn-read w-100">è¯»å–é”€æ¯ä¿¡æ¯</button>
                            </div>
                        </div>
                        <div id="lrbBurnMiniBtcStatus" class="status"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 4. LPFarm åˆçº¦ç®¡ç†ï¼ˆå®Œå…¨åŒ¹é…åˆçº¦æºç ï¼‰ -->
        <div class="contract-card">
            <div class="d-flex justify-content-between align-items-center">
                <h4>LPFarm åˆçº¦é…ç½®</h4>
                <button class="collapse-btn" onclick="toggleCollapse('lpFarmCollapse')">æ”¶èµ· â–²</button>
            </div>
            <div id="lpFarmCollapse" class="collapse-content">
                <!-- setRouter (åˆçº¦ä¸­å®é™…å˜é‡åï¼špancakeRouter) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>1. è®¾ç½® Router åœ°å€ï¼ˆpancakeRouterï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmRouter" class="form-control" placeholder="PancakeSwap Router åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setRouter')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('pancakeRouter')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmRouterStatus" class="status"></div>
                    </div>
                </div>

                <!-- setPricePair (åˆçº¦ä¸­äº¤æ˜“å¯¹åœ°å€ï¼špricePair) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>2. è®¾ç½® MiniBTC-USDT äº¤æ˜“å¯¹åœ°å€ï¼ˆpricePairï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmPricePair" class="form-control" placeholder="MiniBTC-USDT äº¤æ˜“å¯¹åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setPricePair')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('pricePair')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmPricePairStatus" class="status"></div>
                    </div>
                </div>

                <!-- setUsdtToken (åˆçº¦ä¸­å®é™…å˜é‡åï¼šusdtToken) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>3. è®¾ç½® USDT åœ°å€ï¼ˆusdtTokenï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmUsdtToken" class="form-control" placeholder="USDT åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setUsdtToken')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('usdtToken')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmUsdtTokenStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMinibtcToken (åˆçº¦ä¸­å®é™…å˜é‡åï¼šminibtcToken) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>4. è®¾ç½® MiniBTC åœ°å€ï¼ˆminibtcTokenï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmMinibtcToken" class="form-control" placeholder="MiniBTC åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setMinibtcToken')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('minibtcToken')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmMinibtcTokenStatus" class="status"></div>
                    </div>
                </div>

                <!-- setTokenB (åˆçº¦ä¸­å˜é‡åï¼štokenB) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>5. è®¾ç½® TokenB åœ°å€ï¼ˆtokenBï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmTokenB" class="form-control" value="0xbcf1dea324A9Ee13CAD753c1998A69431487f67F" placeholder="TokenB åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setTokenB')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('tokenB')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmTokenBStatus" class="status"></div>
                    </div>
                </div>

                <!-- setReleaseController (åˆçº¦ä¸­å®é™…å‡½æ•°åï¼šsetrewardReleaseController) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>6. è®¾ç½® ReleaseController åœ°å€ï¼ˆReleaseControllerï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmReleaseController" class="form-control" placeholder="ReleaseController åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setrewardReleaseController')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('ReleaseController')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmReleaseControllerStatus" class="status"></div>
                    </div>
                </div>

                <!-- setOneClickLP (åˆçº¦ä¸­å˜é‡åï¼šoneClickLP) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>7. è®¾ç½® OneClickLP åœ°å€ï¼ˆoneClickLPï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmOneClickLP" class="form-control" placeholder="OneClickLP åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setOneClickLP')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('oneClickLP')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmOneClickLPStatus" class="status"></div>
                    </div>
                </div>

                <!-- setAMMAddress (åˆçº¦ä¸­å˜é‡åï¼šammAddress) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>8. è®¾ç½® AMM åœ°å€ï¼ˆammAddressï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="text" id="lpFarmAmmAddress" class="form-control" placeholder="AMM åˆçº¦åœ°å€">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setAMMAddress')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('ammAddress')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmAmmAddressStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMachineActivationPercent (åˆçº¦ä¸­å˜é‡åï¼šmachineActivationPercent) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>9. è®¾ç½®çŸ¿æœºæ¿€æ´»æ¯”ä¾‹ï¼ˆmachineActivationPercentï¼Œ1-100ï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="number" id="lpFarmMachineActivationPercent" class="form-control" placeholder="1-100" min="1" max="100" value="10">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setMachineActivationPercent')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('machineActivationPercent')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmMachineActivationPercentStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMaxStakePercentPerMachine (åˆçº¦ä¸­å˜é‡åï¼šmaxStakePercentPerMachine) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>10. è®¾ç½®å•çŸ¿æœºæœ€å¤§è´¨æŠ¼æ¯”ä¾‹ï¼ˆmaxStakePercentPerMachineï¼Œ1-100ï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="number" id="lpFarmMaxStakePercentPerMachine" class="form-control" placeholder="1-100" min="1" max="100" value="50">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setMaxStakePercentPerMachine')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('maxStakePercentPerMachine')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmMaxStakePercentPerMachineStatus" class="status"></div>
                    </div>
                </div>

                <!-- setMinOut (åˆçº¦ä¸­å˜é‡åï¼šminOut) -->
                <div class="row mb-4">
                    <div class="col-12">
                        <h6>11. è®¾ç½®æœ€å°å…‘æ¢è¾“å‡ºï¼ˆminOutï¼‰</h6>
                        <div class="row align-items-end">
                            <div class="col-md-7">
                                <input type="number" id="lpFarmMinOut" class="form-control" placeholder="æœ€å°è¾“å‡ºæ•°é‡ï¼ˆæœ€å°å•ä½ï¼‰" min="0" value="0">
                            </div>
                            <div class="col-md-3">
                                <button onclick="callLPFarmFunction('setM')" class="btn-custom w-100">æ‰§è¡Œ</button>
                            </div>
                            <div class="col-md-2">
                                <button onclick="readLPFarmConfig('minOut')" class="btn-read w-100">è¯»å–å½“å‰å€¼</button>
                            </div>
                        </div>
                        <div id="lpFarmMinOutStatus" class="status"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ ¸å¿ƒäº¤äº’è„šæœ¬ -->
    <script>
        // å…¨å±€å˜é‡
        let provider, signer, walletAddress;
        // åˆçº¦ABIï¼ˆä¸¥æ ¼åŒ¹é…åˆçº¦æºç ï¼‰
        const oneClickLPABI = [
            "function router() view returns (address)",
            "function factory() view returns (address)",
            "function usdt() view returns (address)",
            "function ammAddress() view returns (address)",
            "function farm() view returns (address)",
            "function minibtc() view returns (address)",
            "function sellFeeBps() view returns (uint256)",
            "function ReleaseController() view returns (address)",
            "function enableLPFromMinibtc() view returns (bool)",
            "function enableLPFromMinibtcAndUsdt() view returns (bool)",
            "function enableLPFromUsdt() view returns (bool)",
            "function setRouter(address _router) external",
            "function setFactory(address _factory) external",
            "function setUsdt(address _usdt) external",
            "function setAMMAddress(address _amm) external",
            "function setFarm(address _farm) external",
            "function setMinibtc(address _minibtc) external",
            "function setSellFeeBps(uint256 _bps) external",
            "function setReleaseController(address _address) external",
            "function setLPCreateWay(bool minibtc, bool minibtcAndUsdt, bool usdt_) external"
        ];

        const releaseControllerABI = [
            "function usdtToken() view returns (address)",
            "function feeEOA() view returns (address)",
            "function farmContract() view returns (address)",
            "function transferAdmin() view returns (address)",
            "function transferPerm() view returns (bool)",
            "function minibtc() view returns (address)",
            "function minibtcPair() view returns (address)",
            "function rewardSigner() view returns (address)",
            "function fireflyNFT() view returns (address)",
            "function setUsdtToken(address _token) external",
            "function setFeeEOA(address _eoa) external",
            "function setFarmContract(address _farm) external",
            "function setTransferAdmin(address _admin) external",
            "function toggleTransferPerm(bool _enable) external",
            "function setMinibtcConfig(address _minibtc, address _pair) external",
            "function setRewardSigner(address _signer) external",
            "function setFireflyNFT(address _nft) external"
        ];

        const lpRewardBurnABI = [
            "function token() view returns (address)",
            "function rewardSigner() view returns (address)",
            "function burnBlackHole() view returns (address)",
            "function MAX_BURN_PER_DAY() view returns (uint256)",
            "function lastBurnTime() view returns (uint256)",
            "function setToken(address _token) external",
            "function setRewardSigner(address _signer) external",
            "function setBurnBlackHole(address _burnBlackHole) external",
            "function setMaxBurnPerDay(uint256 _max) external",
            "function BurnMiniBtc(uint256 burnAmount, string calldata burnDate) external"
        ];

        // LPFarm ABIï¼ˆä¸¥æ ¼åŒ¹é…åˆçº¦æºç ï¼Œæ— å¤šä½™å‡½æ•°ï¼‰
        const lpFarmABI = [
            // è¯»å–å‡½æ•°ï¼ˆå®Œå…¨åŒ¹é…åˆçº¦å˜é‡åï¼‰
            "function pancakeRouter() view returns (address)",
            "function pricePair() view returns (address)",
            "function usdtToken() view returns (address)",
            "function minibtcToken() view returns (address)",
            "function tokenB() view returns (address)",
            "function ReleaseController() view returns (address)",
            "function oneClickLP() view returns (address)",
            "function ammAddress() view returns (address)",
            "function machineActivationPercent() view returns (uint256)",
            "function maxStakePercentPerMachine() view returns (uint256)",
            "function minOut() view returns (uint256)",
            // è®¾ç½®å‡½æ•°ï¼ˆå®Œå…¨åŒ¹é…åˆçº¦å‡½æ•°åï¼‰
            "function setRouter(address r) external",
            "function setPricePair(address p) external",
            "function setUsdtToken(address _usdtToken) external",
            "function setMinibtcToken(address _minibtcToken) external",
            "function setTokenB(address _tokenB) external",
            "function setrewardReleaseController(address _address) external",
            "function setOneClickLP(address _oneClickLP) external",
            "function setAMMAddress(address _amm) external",
            "function setMachineActivationPercent(uint256 pct) external",
            "function setMaxStakePercentPerMachine(uint256 pct) external",
            "function setM(uint256 _minOut) external"
        ];

        // ========== ä¿®å¤åçš„é’±åŒ…è¿æ¥é€»è¾‘ ==========
        window.addEventListener('DOMContentLoaded', async () => {
            if (window.ethereum) {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                    if (accounts.length > 0) {
                        initWallet(accounts[0]);
                    }
                } catch (err) {
                    console.log('æ£€æŸ¥é’±åŒ…çŠ¶æ€å¤±è´¥:', err);
                }

                window.ethereum.on('accountsChanged', (accounts) => {
                    if (accounts.length > 0) {
                        initWallet(accounts[0]);
                    } else {
                        resetWalletStatus();
                    }
                });

                window.ethereum.on('chainChanged', (chainId) => {
                    window.location.reload();
                });
            }
        });

        async function initWallet(addr) {
            walletAddress = addr;
            provider = new ethers.providers.Web3Provider(window.ethereum, 'any');
            await provider.send('eth_requestAccounts', []);
            signer = provider.getSigner();
            
            document.getElementById('walletStatus').textContent = `å·²è¿æ¥: ${walletAddress.substring(0, 6)}...${walletAddress.substring(38)}`;
            document.getElementById('walletStatus').style.color = '#198754';
            document.getElementById('connectWallet').textContent = 'åˆ‡æ¢é’±åŒ…';
        }

        function resetWalletStatus() {
            walletAddress = null;
            provider = null;
            signer = null;
            document.getElementById('walletStatus').textContent = 'æœªè¿æ¥é’±åŒ…';
            document.getElementById('walletStatus').style.color = '#6c757d';
            document.getElementById('connectWallet').textContent = 'è¿æ¥é’±åŒ…';
        }

        document.getElementById('connectWallet').addEventListener('click', async () => {
            if (!window.ethereum) {
                alert('è¯·å®‰è£…MetaMaské’±åŒ…ï¼ˆæˆ–å…¶ä»–EVMå…¼å®¹é’±åŒ…ï¼‰ï¼');
                return;
            }

            try {
                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts',
                    params: [{ eth_accounts: {} }]
                });

                if (accounts.length === 0) {
                    throw new Error('æœªæˆæƒä»»ä½•è´¦æˆ·');
                }

                initWallet(accounts[0]);
            } catch (error) {
                document.getElementById('walletStatus').textContent = `è¿æ¥å¤±è´¥: ${error.message}`;
                document.getElementById('walletStatus').style.color = '#dc3545';
                console.error('é’±åŒ…è¿æ¥é”™è¯¯:', error);
            }
        });

        // åˆ‡æ¢é“¾é€»è¾‘
        document.getElementById('chainSelector').addEventListener('change', async (e) => {
            if (!window.ethereum) {
                alert('è¯·å®‰è£…MetaMaské’±åŒ…ï¼');
                return;
            }

            const chainId = e.target.value;
            const hexChainId = ethers.utils.hexValue(parseInt(chainId));

            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: hexChainId }],
                });
            } catch (switchError) {
                if (switchError.code === 4902) {
                    alert(`å½“å‰é’±åŒ…æœªæ·»åŠ è¯¥é“¾ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ é“¾ID ${chainId} åé‡è¯•ï¼`);
                } else {
                    alert(`åˆ‡æ¢é“¾å¤±è´¥: ${switchError.message}`);
                }
            }
        });

        // è§£é”/é”å®šè¾“å…¥æ¡†
        function unlockInput(id) {
            const input = document.getElementById(id);
            if (input.readOnly) {
                input.readOnly = false;
                input.style.backgroundColor = '#fff';
                input.style.cursor = 'text';
                const unlockBtn = input.parentElement.querySelector('.btn-unlock');
                unlockBtn.textContent = 'ğŸ”’ é”å®š';
                unlockBtn.onclick = () => lockInput(id);
            }
        }

        function lockInput(id) {
            const input = document.getElementById(id);
            input.readOnly = true;
            input.style.backgroundColor = '#f8f9fa';
            input.style.cursor = 'not-allowed';
            const unlockBtn = input.parentElement.querySelector('.btn-unlock');
            unlockBtn.textContent = 'ğŸ”“ è§£é”';
            unlockBtn.onclick = () => unlockInput(id);
        }

        // æŠ˜å /å±•å¼€é¢æ¿
        function toggleCollapse(id) {
            const content = document.getElementById(id);
            const btn = content.parentElement.querySelector('.collapse-btn');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                btn.textContent = 'æ”¶èµ· â–²';
            } else {
                content.style.display = 'none';
                btn.textContent = 'å±•å¼€ â–¼';
            }
        }

        // ========== è¯»å–é…ç½®å‡½æ•° ==========
        // è¯»å–OneClickLPé…ç½®
        async function readOneClickLPConfig(configKey) {
            if (!provider) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('oneClickLPAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('OneClickLPåœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, oneClickLPABI, provider);
            const statusEl = document.getElementById(`oneClickLP${configKey === 'ammAddress' ? 'AMM' : configKey.charAt(0).toUpperCase() + configKey.slice(1)}Status`);
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'æ­£åœ¨è¯»å–é…ç½®...';
                
                let value;
                switch(configKey) {
                    case 'router': value = await contract.router(); break;
                    case 'factory': value = await contract.factory(); break;
                    case 'usdt': value = await contract.usdt(); break;
                    case 'ammAddress': value = await contract.ammAddress(); break;
                    case 'farm': value = await contract.farm(); break;
                    case 'minibtc': value = await contract.minibtc(); break;
                    case 'sellFeeBps': value = await contract.sellFeeBps(); break;
                    case 'ReleaseController': value = await contract.ReleaseController(); break;
                    case 'lpCreateWay': 
                        const isMinibtcEnabled = await contract.enableLPFromMinibtc();
                        const isMinibtcUsdtEnabled = await contract.enableLPFromMinibtcAndUsdt();
                        const isUsdtEnabled = await contract.enableLPFromUsdt();
                        document.getElementById('lpWayMinibtc').checked = isMinibtcEnabled;
                        document.getElementById('lpWayMinibtcUsdt').checked = isMinibtcUsdtEnabled;
                        document.getElementById('lpWayUsdt').checked = isUsdtEnabled;
                        statusEl.className = 'status success';
                        statusEl.textContent = 'è¯»å–LPåˆ›å»ºæ–¹å¼æˆåŠŸï¼';
                        return;
                    default: return alert('æ— æ•ˆçš„é…ç½®é¡¹ï¼');
                }
                
                const inputId = configKey === 'ammAddress' ? 'oneClickLPAMM' : `oneClickLP${configKey.charAt(0).toUpperCase() + configKey.slice(1)}`;
                document.getElementById(inputId).value = value;
                
                statusEl.className = 'status success';
                statusEl.textContent = `è¯»å–æˆåŠŸ: ${value}`;
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = `è¯»å–å¤±è´¥: ${error.message}`;
            }
        }

        // è¯»å–ReleaseControlleré…ç½®
        async function readReleaseControllerConfig(configKey) {
            if (!provider) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('releaseControllerAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('ReleaseControlleråœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, releaseControllerABI, provider);
            const statusEl = document.getElementById(`rc${configKey.charAt(0).toUpperCase() + configKey.slice(1)}Status`);
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'æ­£åœ¨è¯»å–é…ç½®...';
                
                let value;
                switch(configKey) {
                    case 'usdtToken': value = await contract.usdtToken(); break;
                    case 'feeEOA': value = await contract.feeEOA(); break;
                    case 'farmContract': value = await contract.farmContract(); break;
                    case 'transferAdmin': value = await contract.transferAdmin(); break;
                    case 'transferPerm': value = await contract.transferPerm(); break;
                    case 'minibtcConfig':
                        const minibtc = await contract.minibtc();
                        const pair = await contract.minibtcPair();
                        document.getElementById('rcMinibtc').value = minibtc;
                        document.getElementById('rcMinibtcPair').value = pair;
                        statusEl.className = 'status success';
                        statusEl.textContent = 'è¯»å–MiniBTCé…ç½®æˆåŠŸï¼';
                        return;
                    case 'rewardSigner': value = await contract.rewardSigner(); break;
                    case 'fireflyNFT': value = await contract.fireflyNFT(); break;
                    default: return alert('æ— æ•ˆçš„é…ç½®é¡¹ï¼');
                }
                
                if (configKey === 'transferPerm') {
                    document.getElementById('rcTransferPerm').value = value.toString();
                } else {
                    document.getElementById(`rc${configKey.charAt(0).toUpperCase() + configKey.slice(1)}`).value = value;
                }
                
                statusEl.className = 'status success';
                statusEl.textContent = `è¯»å–æˆåŠŸ: ${value}`;
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = `è¯»å–å¤±è´¥: ${error.message}`;
            }
        }

        // è¯»å–LPRewardBurné…ç½®
        async function readLPRewardBurnConfig(configKey) {
            if (!provider) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('lpRewardBurnAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('LPRewardBurnåœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, lpRewardBurnABI, provider);
            const statusEl = document.getElementById(`lrb${configKey.charAt(0).toUpperCase() + configKey.slice(1)}Status`) || document.getElementById('lrbBurnMiniBtcStatus');
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'æ­£åœ¨è¯»å–é…ç½®...';
                
                let value;
                switch(configKey) {
                    case 'token': value = await contract.token(); break;
                    case 'rewardSigner': value = await contract.rewardSigner(); break;
                    case 'burnBlackHole': value = await contract.burnBlackHole(); break;
                    case 'maxBurnPerDay': value = await contract.MAX_BURN_PER_DAY(); break;
                    case 'lastBurnInfo':
                        const lastTime = await contract.lastBurnTime();
                        const maxBurn = await contract.MAX_BURN_PER_DAY();
                        const remainingTime = lastTime + 86400 - Math.floor(Date.now()/1000);
                        let timeText = remainingTime > 0 ? `${Math.floor(remainingTime/3600)}å°æ—¶${Math.floor((remainingTime%3600)/60)}åˆ†é’Ÿ` : 'å¯ç«‹å³é”€æ¯';
                        statusEl.className = 'status success';
                        statusEl.textContent = `æœ€åé”€æ¯æ—¶é—´: ${new Date(lastTime * 1000).toLocaleString()}, æ¯æ—¥æœ€å¤§é”€æ¯é‡: ${maxBurn}, ä¸‹æ¬¡é”€æ¯æ—¶é—´: ${timeText}`;
                        return;
                    default: return alert('æ— æ•ˆçš„é…ç½®é¡¹ï¼');
                }
                
                document.getElementById(`lrb${configKey.charAt(0).toUpperCase() + configKey.slice(1)}`).value = value;
                
                statusEl.className = 'status success';
                statusEl.textContent = `è¯»å–æˆåŠŸ: ${value}`;
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = `è¯»å–å¤±è´¥: ${error.message}`;
            }
        }

        // è¯»å–LPFarmé…ç½®ï¼ˆå®Œå…¨åŒ¹é…åˆçº¦æºç ï¼‰
        async function readLPFarmConfig(configKey) {
            if (!provider) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('lpFarmAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('LPFarmåœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, lpFarmABI, provider);
            const statusElMap = {
                'pancakeRouter': 'lpFarmRouterStatus',
                'pricePair': 'lpFarmPricePairStatus',
                'usdtToken': 'lpFarmUsdtTokenStatus',
                'minibtcToken': 'lpFarmMinibtcTokenStatus',
                'tokenB': 'lpFarmTokenBStatus',
                'ReleaseController': 'lpFarmReleaseControllerStatus',
                'oneClickLP': 'lpFarmOneClickLPStatus',
                'ammAddress': 'lpFarmAmmAddressStatus',
                'machineActivationPercent': 'lpFarmMachineActivationPercentStatus',
                'maxStakePercentPerMachine': 'lpFarmMaxStakePercentPerMachineStatus',
                'minOut': 'lpFarmMinOutStatus'
            };
            const statusEl = document.getElementById(statusElMap[configKey]);
            if (!statusEl) return alert('æ— æ•ˆçš„é…ç½®é¡¹ï¼');
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'æ­£åœ¨è¯»å–é…ç½®...';
                
                let value;
                switch(configKey) {
                    case 'pancakeRouter': value = await contract.pancakeRouter(); break;
                    case 'pricePair': value = await contract.pricePair(); break;
                    case 'usdtToken': value = await contract.usdtToken(); break;
                    case 'minibtcToken': value = await contract.minibtcToken(); break;
                    case 'tokenB': value = await contract.tokenB(); break;
                    case 'ReleaseController': value = await contract.ReleaseController(); break;
                    case 'oneClickLP': value = await contract.oneClickLP(); break;
                    case 'ammAddress': value = await contract.ammAddress(); break;
                    case 'machineActivationPercent': value = await contract.machineActivationPercent(); break;
                    case 'maxStakePercentPerMachine': value = await contract.maxStakePercentPerMachine(); break;
                    case 'minOut': value = await contract.minOut(); break;
                    default: throw new Error('æ— æ•ˆçš„é…ç½®é¡¹ï¼');
                }
                
                // åŒ¹é…è¾“å…¥æ¡†ID
                const inputIdMap = {
                    'pancakeRouter': 'lpFarmRouter',
                    'pricePair': 'lpFarmPricePair',
                    'usdtToken': 'lpFarmUsdtToken',
                    'minibtcToken': 'lpFarmMinibtcToken',
                    'tokenB': 'lpFarmTokenB',
                    'ReleaseController': 'lpFarmReleaseController',
                    'oneClickLP': 'lpFarmOneClickLP',
                    'ammAddress': 'lpFarmAmmAddress',
                    'machineActivationPercent': 'lpFarmMachineActivationPercent',
                    'maxStakePercentPerMachine': 'lpFarmMaxStakePercentPerMachine',
                    'minOut': 'lpFarmMinOut'
                };
                document.getElementById(inputIdMap[configKey]).value = value;
                
                statusEl.className = 'status success';
                statusEl.textContent = `è¯»å–æˆåŠŸ: ${value}`;
            } catch (error) {
                let errorMsg = '';
                if (error.message.includes('CALL_EXCEPTION')) {
                    errorMsg = `è¯»å–å¤±è´¥ï¼šåˆçº¦ä¸­æœªæ‰¾åˆ° ${configKey}() å‡½æ•°ï¼ˆæƒé™ä¸è¶³æˆ–å‡½æ•°åä¸åŒ¹é…ï¼‰`;
                } else {
                    errorMsg = `è¯»å–å¤±è´¥: ${error.message}`;
                }
                statusEl.className = 'status error';
                statusEl.textContent = errorMsg;
                console.error('LPFarmè¯»å–é”™è¯¯:', error);
            }
        }

        // ========== æ‰§è¡Œè®¾ç½®å‡½æ•° ==========
        // æ‰§è¡ŒOneClickLPå‡½æ•°ï¼ˆä¿®å¤å˜é‡åå†²çªï¼‰
        async function callOneClickLPFunction(funcName) {
            if (!provider || !signer) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('oneClickLPAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('OneClickLPåœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, oneClickLPABI, signer);
            const statusEl = document.getElementById(`oneClickLP${funcName.charAt(0).toUpperCase() + funcName.slice(1)}Status`);
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'äº¤æ˜“å¤„ç†ä¸­ï¼Œè¯·ç­‰å¾…...';
                
                let tx;
                switch(funcName) {
                    case 'setRouter':
                        const routerAddr = document.getElementById('oneClickLPRouter').value;
                        if (!ethers.utils.isAddress(routerAddr)) throw new Error('Routeråœ°å€æ— æ•ˆ');
                        tx = await contract.setRouter(routerAddr);
                        break;
                    case 'setFactory':
                        const factoryAddr = document.getElementById('oneClickLPFactory').value;
                        if (!ethers.utils.isAddress(factoryAddr)) throw new Error('Factoryåœ°å€æ— æ•ˆ');
                        tx = await contract.setFactory(factoryAddr);
                        break;
                    case 'setUsdt':
                        const usdtAddr = document.getElementById('oneClickLPUsdt').value;
                        if (!ethers.utils.isAddress(usdtAddr)) throw new Error('USDTåœ°å€æ— æ•ˆ');
                        tx = await contract.setUsdt(usdtAddr);
                        break;
                    case 'setAMMAddress':
                        const ammAddr = document.getElementById('oneClickLPAMM').value;
                        if (!ethers.utils.isAddress(ammAddr)) throw new Error('AMMåœ°å€æ— æ•ˆ');
                        if (ammAddr === '0x0000000000000000000000000000000000000000') throw new Error('AMMåœ°å€ä¸èƒ½ä¸ºé›¶åœ°å€');
                        tx = await contract.setAMMAddress(ammAddr);
                        break;
                    case 'setFarm':
                        const farmAddr = document.getElementById('oneClickLPFarm').value;
                        if (!ethers.utils.isAddress(farmAddr)) throw new Error('Farmåœ°å€æ— æ•ˆ');
                        tx = await contract.setFarm(farmAddr);
                        break;
                    case 'setMinibtc':
                        const minibtcAddr = document.getElementById('oneClickLPMinibtc').value;
                        if (!ethers.utils.isAddress(minibtcAddr)) throw new Error('MiniBTCåœ°å€æ— æ•ˆ');
                        tx = await contract.setMinibtc(minibtcAddr);
                        break;
                    case 'setSellFeeBps':
                        const sellFeeBpsValue = document.getElementById('oneClickLPSellFeeBps').value;
                        if (sellFeeBpsValue < 0 || sellFeeBpsValue > 10000) throw new Error('æ‰‹ç»­è´¹èŒƒå›´0-10000');
                        tx = await contract.setSellFeeBps(sellFeeBpsValue);
                        break;
                    case 'setReleaseController':
                        const rcAddr = document.getElementById('oneClickLPReleaseController').value;
                        if (!ethers.utils.isAddress(rcAddr)) throw new Error('ReleaseControlleråœ°å€æ— æ•ˆ');
                        tx = await contract.setReleaseController(rcAddr);
                        break;
                    case 'setLPCreateWay':
                        const isMinibtcEnabled = document.getElementById('lpWayMinibtc').checked;
                                                const isMinibtcUsdtEnabled = document.getElementById('lpWayMinibtcUsdt').checked;
                        const isUsdtEnabled = document.getElementById('lpWayUsdt').checked;
                        tx = await contract.setLPCreateWay(isMinibtcEnabled, isMinibtcUsdtEnabled, isUsdtEnabled);
                        break;
                    default:
                        throw new Error(`ä¸æ”¯æŒçš„å‡½æ•°: ${funcName}`);
                }

                // ç­‰å¾…äº¤æ˜“ä¸Šé“¾
                await tx.wait();
                statusEl.className = 'status success';
                statusEl.textContent = 'æ“ä½œæˆåŠŸï¼äº¤æ˜“å“ˆå¸Œ: ' + tx.hash.substring(0, 10) + '...';
                
                // é‡æ–°è¯»å–é…ç½®åˆ·æ–°æ˜¾ç¤º
                const configKeyMap = {
                    'setRouter': 'router',
                    'setFactory': 'factory',
                    'setUsdt': 'usdt',
                    'setAMMAddress': 'ammAddress',
                    'setFarm': 'farm',
                    'setMinibtc': 'minibtc',
                    'setSellFeeBps': 'sellFeeBps',
                    'setReleaseController': 'ReleaseController',
                    'setLPCreateWay': 'lpCreateWay'
                };
                if (configKeyMap[funcName]) {
                    setTimeout(() => readOneClickLPConfig(configKeyMap[funcName]), 1000);
                }
            } catch (error) {
                let errorMsg = error.message;
                if (errorMsg.includes('only owner')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šä»…åˆçº¦æ‹¥æœ‰è€…å¯è°ƒç”¨è¯¥å‡½æ•°';
                } else if (errorMsg.includes('invalid address')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šæ— æ•ˆçš„åœ°å€æ ¼å¼';
                } else if (errorMsg.length > 100) {
                    errorMsg = errorMsg.substring(0, 100) + '...';
                }
                
                statusEl.className = 'status error';
                statusEl.textContent = `æ‰§è¡Œå¤±è´¥: ${errorMsg}`;
                console.error('OneClickLPæ‰§è¡Œé”™è¯¯:', error);
            }
        }

        // æ‰§è¡ŒReleaseControllerå‡½æ•°
        async function callReleaseControllerFunction(funcName) {
            if (!provider || !signer) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('releaseControllerAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('ReleaseControlleråœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, releaseControllerABI, signer);
            const statusEl = document.getElementById(`rc${funcName.charAt(0).toUpperCase() + funcName.slice(1)}Status`);
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'äº¤æ˜“å¤„ç†ä¸­ï¼Œè¯·ç­‰å¾…...';
                
                let tx;
                switch(funcName) {
                    case 'setUsdtToken':
                        const usdtAddr = document.getElementById('rcUsdtToken').value;
                        if (!ethers.utils.isAddress(usdtAddr)) throw new Error('USDTåœ°å€æ— æ•ˆ');
                        tx = await contract.setUsdtToken(usdtAddr);
                        break;
                    case 'setFeeEOA':
                        const feeEOAAddr = document.getElementById('rcFeeEOA').value;
                        if (!ethers.utils.isAddress(feeEOAAddr)) throw new Error('æ‰‹ç»­è´¹æ¥æ”¶åœ°å€æ— æ•ˆ');
                        tx = await contract.setFeeEOA(feeEOAAddr);
                        break;
                    case 'setFarmContract':
                        const farmAddr = document.getElementById('rcFarmContract').value;
                        if (!ethers.utils.isAddress(farmAddr)) throw new Error('Farmåˆçº¦åœ°å€æ— æ•ˆ');
                        tx = await contract.setFarmContract(farmAddr);
                        break;
                    case 'setTransferAdmin':
                        const adminAddr = document.getElementById('rcTransferAdmin').value;
                        if (!ethers.utils.isAddress(adminAddr)) throw new Error('è½¬è´¦ç®¡ç†å‘˜åœ°å€æ— æ•ˆ');
                        tx = await contract.setTransferAdmin(adminAddr);
                        break;
                    case 'toggleTransferPerm':
                        const isEnabled = document.getElementById('rcTransferPerm').value === 'true';
                        tx = await contract.toggleTransferPerm(isEnabled);
                        break;
                    case 'setMinibtcConfig':
                        const minibtcAddr = document.getElementById('rcMinibtc').value;
                        const pairAddr = document.getElementById('rcMinibtcPair').value;
                        if (!ethers.utils.isAddress(minibtcAddr)) throw new Error('MiniBTCåœ°å€æ— æ•ˆ');
                        if (!ethers.utils.isAddress(pairAddr)) throw new Error('MiniBTCäº¤æ˜“å¯¹åœ°å€æ— æ•ˆ');
                        tx = await contract.setMinibtcConfig(minibtcAddr, pairAddr);
                        break;
                    case 'setRewardSigner':
                        const signerAddr = document.getElementById('rcRewardSigner').value;
                        if (!ethers.utils.isAddress(signerAddr)) throw new Error('å¥–åŠ±ç­¾åè€…åœ°å€æ— æ•ˆ');
                        tx = await contract.setRewardSigner(signerAddr);
                        break;
                    case 'setFireflyNFT':
                        const nftAddr = document.getElementById('rcFireflyNFT').value;
                        if (!ethers.utils.isAddress(nftAddr)) throw new Error('FireflyNFTåœ°å€æ— æ•ˆ');
                        tx = await contract.setFireflyNFT(nftAddr);
                        break;
                    default:
                        throw new Error(`ä¸æ”¯æŒçš„å‡½æ•°: ${funcName}`);
                }

                await tx.wait();
                statusEl.className = 'status success';
                statusEl.textContent = 'æ“ä½œæˆåŠŸï¼äº¤æ˜“å“ˆå¸Œ: ' + tx.hash.substring(0, 10) + '...';
                
                // é‡æ–°è¯»å–é…ç½®
                const configKeyMap = {
                    'setUsdtToken': 'usdtToken',
                    'setFeeEOA': 'feeEOA',
                    'setFarmContract': 'farmContract',
                    'setTransferAdmin': 'transferAdmin',
                    'toggleTransferPerm': 'transferPerm',
                    'setMinibtcConfig': 'minibtcConfig',
                    'setRewardSigner': 'rewardSigner',
                    'setFireflyNFT': 'fireflyNFT'
                };
                if (configKeyMap[funcName]) {
                    setTimeout(() => readReleaseControllerConfig(configKeyMap[funcName]), 1000);
                }
            } catch (error) {
                let errorMsg = error.message;
                if (errorMsg.includes('only owner')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šä»…åˆçº¦æ‹¥æœ‰è€…å¯è°ƒç”¨è¯¥å‡½æ•°';
                } else if (errorMsg.includes('invalid address')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šæ— æ•ˆçš„åœ°å€æ ¼å¼';
                } else if (errorMsg.length > 100) {
                    errorMsg = errorMsg.substring(0, 100) + '...';
                }
                
                statusEl.className = 'status error';
                statusEl.textContent = `æ‰§è¡Œå¤±è´¥: ${errorMsg}`;
                console.error('ReleaseControlleræ‰§è¡Œé”™è¯¯:', error);
            }
        }

        // æ‰§è¡ŒLPRewardBurnå‡½æ•°
        async function callLPRewardBurnFunction(funcName) {
            if (!provider || !signer) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('lpRewardBurnAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('LPRewardBurnåœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, lpRewardBurnABI, signer);
            const statusEl = document.getElementById(`lrb${funcName.charAt(0).toUpperCase() + funcName.slice(1)}Status`) || document.getElementById('lrbBurnMiniBtcStatus');
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'äº¤æ˜“å¤„ç†ä¸­ï¼Œè¯·ç­‰å¾…...';
                
                let tx;
                switch(funcName) {
                    case 'setToken':
                        const tokenAddr = document.getElementById('lrbToken').value;
                        if (!ethers.utils.isAddress(tokenAddr)) throw new Error('å¥–åŠ±ä»£å¸åœ°å€æ— æ•ˆ');
                        tx = await contract.setToken(tokenAddr);
                        break;
                    case 'setRewardSigner':
                        const signerAddr = document.getElementById('lrbRewardSigner').value;
                        if (!ethers.utils.isAddress(signerAddr)) throw new Error('å¥–åŠ±ç­¾åè€…åœ°å€æ— æ•ˆ');
                        tx = await contract.setRewardSigner(signerAddr);
                        break;
                    case 'setBurnBlackHole':
                        const blackHoleAddr = document.getElementById('lrbBurnBlackHole').value || '0x000000000000000000000000000000000000dEaD';
                        if (!ethers.utils.isAddress(blackHoleAddr)) throw new Error('é»‘æ´åœ°å€æ— æ•ˆ');
                        tx = await contract.setBurnBlackHole(blackHoleAddr);
                        break;
                    case 'setMaxBurnPerDay':
                        const maxBurn = document.getElementById('lrbMaxBurnPerDay').value;
                        if (maxBurn < 0) throw new Error('æ¯æ—¥æœ€å¤§é”€æ¯é‡ä¸èƒ½ä¸ºè´Ÿæ•°');
                        tx = await contract.setMaxBurnPerDay(ethers.BigNumber.from(maxBurn));
                        break;
                    case 'BurnMiniBtc':
                        const burnAmount = document.getElementById('lrbBurnAmount').value;
                        const burnDate = document.getElementById('lrbBurnDate').value;
                        if (burnAmount < 1) throw new Error('é”€æ¯æ•°é‡å¿…é¡»å¤§äº0');
                        if (!/^\d{4}-\d{2}-\d{2}$/.test(burnDate)) throw new Error('æ—¥æœŸæ ¼å¼é”™è¯¯ï¼ˆéœ€ä¸ºYYYY-MM-DDï¼‰');
                        tx = await contract.BurnMiniBtc(ethers.BigNumber.from(burnAmount), burnDate);
                        break;
                    default:
                        throw new Error(`ä¸æ”¯æŒçš„å‡½æ•°: ${funcName}`);
                }

                await tx.wait();
                statusEl.className = 'status success';
                statusEl.textContent = 'æ“ä½œæˆåŠŸï¼äº¤æ˜“å“ˆå¸Œ: ' + tx.hash.substring(0, 10) + '...';
                
                // é‡æ–°è¯»å–é…ç½®
                const configKeyMap = {
                    'setToken': 'token',
                    'setRewardSigner': 'rewardSigner',
                    'setBurnBlackHole': 'burnBlackHole',
                    'setMaxBurnPerDay': 'maxBurnPerDay',
                    'BurnMiniBtc': 'lastBurnInfo'
                };
                if (configKeyMap[funcName]) {
                    setTimeout(() => readLPRewardBurnConfig(configKeyMap[funcName]), 1000);
                }
            } catch (error) {
                let errorMsg = error.message;
                if (errorMsg.includes('only owner')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šä»…åˆçº¦æ‹¥æœ‰è€…å¯è°ƒç”¨è¯¥å‡½æ•°';
                } else if (errorMsg.includes('invalid address')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šæ— æ•ˆçš„åœ°å€æ ¼å¼';
                } else if (errorMsg.length > 100) {
                    errorMsg = errorMsg.substring(0, 100) + '...';
                }
                
                statusEl.className = 'status error';
                statusEl.textContent = `æ‰§è¡Œå¤±è´¥: ${errorMsg}`;
                console.error('LPRewardBurnæ‰§è¡Œé”™è¯¯:', error);
            }
        }

        // æ‰§è¡ŒLPFarmå‡½æ•°ï¼ˆå®Œå…¨åŒ¹é…åˆçº¦æºç ï¼‰
        async function callLPFarmFunction(funcName) {
            if (!provider || !signer) return alert('è¯·å…ˆè¿æ¥é’±åŒ…ï¼');
            const contractAddr = document.getElementById('lpFarmAddr').value;
            if (!ethers.utils.isAddress(contractAddr)) return alert('LPFarmåœ°å€æ— æ•ˆï¼');
            
            const contract = new ethers.Contract(contractAddr, lpFarmABI, signer);
            // æ˜ å°„çŠ¶æ€æç¤ºæ¡†ID
            const statusElMap = {
                'setRouter': 'lpFarmRouterStatus',
                'setPricePair': 'lpFarmPricePairStatus',
                'setUsdtToken': 'lpFarmUsdtTokenStatus',
                'setMinibtcToken': 'lpFarmMinibtcTokenStatus',
                'setTokenB': 'lpFarmTokenBStatus',
                'setrewardReleaseController': 'lpFarmReleaseControllerStatus',
                'setOneClickLP': 'lpFarmOneClickLPStatus',
                'setAMMAddress': 'lpFarmAmmAddressStatus',
                'setMachineActivationPercent': 'lpFarmMachineActivationPercentStatus',
                'setMaxStakePercentPerMachine': 'lpFarmMaxStakePercentPerMachineStatus',
                'setM': 'lpFarmMinOutStatus'
            };
            const statusEl = document.getElementById(statusElMap[funcName]);
            if (!statusEl) return alert('æ— æ•ˆçš„é…ç½®é¡¹ï¼');
            
            try {
                statusEl.className = 'status loading';
                statusEl.textContent = 'äº¤æ˜“å¤„ç†ä¸­ï¼Œè¯·ç­‰å¾…...';
                
                let tx;
                switch(funcName) {
                    // åœ°å€ç±»é…ç½®
                    case 'setRouter':
                        const routerAddr = document.getElementById('lpFarmRouter').value.trim();
                        if (!ethers.utils.isAddress(routerAddr)) throw new Error('Routeråœ°å€æ— æ•ˆ');
                        tx = await contract.setRouter(routerAddr);
                        break;
                    case 'setPricePair':
                        const pricePairAddr = document.getElementById('lpFarmPricePair').value.trim();
                        if (!ethers.utils.isAddress(pricePairAddr)) throw new Error('äº¤æ˜“å¯¹åœ°å€æ— æ•ˆ');
                        tx = await contract.setPricePair(pricePairAddr);
                        break;
                    case 'setUsdtToken':
                        const usdtAddr = document.getElementById('lpFarmUsdtToken').value.trim();
                        if (!ethers.utils.isAddress(usdtAddr)) throw new Error('USDTåœ°å€æ— æ•ˆ');
                        tx = await contract.setUsdtToken(usdtAddr);
                        break;
                    case 'setMinibtcToken':
                        const minibtcAddr = document.getElementById('lpFarmMinibtcToken').value.trim();
                        if (!ethers.utils.isAddress(minibtcAddr)) throw new Error('MiniBTCåœ°å€æ— æ•ˆ');
                        tx = await contract.setMinibtcToken(minibtcAddr);
                        break;
                    case 'setTokenB':
                        const tokenBAddr = document.getElementById('lpFarmTokenB').value.trim();
                        if (!ethers.utils.isAddress(tokenBAddr)) throw new Error('TokenBåœ°å€æ— æ•ˆ');
                        tx = await contract.setTokenB(tokenBAddr);
                        break;
                    case 'setrewardReleaseController':
                        const rcAddr = document.getElementById('lpFarmReleaseController').value.trim();
                        if (!ethers.utils.isAddress(rcAddr)) throw new Error('ReleaseControlleråœ°å€æ— æ•ˆ');
                        tx = await contract.setrewardReleaseController(rcAddr);
                        break;
                    case 'setOneClickLP':
                        const oneClickLPAddr = document.getElementById('lpFarmOneClickLP').value.trim();
                        if (!ethers.utils.isAddress(oneClickLPAddr)) throw new Error('OneClickLPåœ°å€æ— æ•ˆ');
                        tx = await contract.setOneClickLP(oneClickLPAddr);
                        break;
                    case 'setAMMAddress':
                        const ammAddr = document.getElementById('lpFarmAmmAddress').value.trim();
                        if (!ethers.utils.isAddress(ammAddr)) throw new Error('AMMåœ°å€æ— æ•ˆ');
                        tx = await contract.setAMMAddress(ammAddr);
                        break;
                    
                    // æ•°å€¼ç±»é…ç½®
                    case 'setMachineActivationPercent':
                        const activationPct = ethers.BigNumber.from(document.getElementById('lpFarmMachineActivationPercent').value.trim());
                        if (activationPct.lt(1) || activationPct.gt(100)) throw new Error('æ¿€æ´»æ¯”ä¾‹å¿…é¡»ä¸º1-100');
                        tx = await contract.setMachineActivationPercent(activationPct);
                        break;
                    case 'setMaxStakePercentPerMachine':
                        const maxStakePct = ethers.BigNumber.from(document.getElementById('lpFarmMaxStakePercentPerMachine').value.trim());
                        if (maxStakePct.lt(1) || maxStakePct.gt(100)) throw new Error('æœ€å¤§è´¨æŠ¼æ¯”ä¾‹å¿…é¡»ä¸º1-100');
                        tx = await contract.setMaxStakePercentPerMachine(maxStakePct);
                        break;
                    case 'setM':
                        const minOutValue = ethers.BigNumber.from(document.getElementById('lpFarmMinOut').value.trim());
                        tx = await contract.setM(minOutValue);
                        break;
                    
                    default:
                        throw new Error(`ä¸æ”¯æŒçš„å‡½æ•°: ${funcName}`);
                }

                await tx.wait();
                statusEl.className = 'status success';
                statusEl.textContent = 'æ“ä½œæˆåŠŸï¼äº¤æ˜“å“ˆå¸Œ: ' + tx.hash.substring(0, 10) + '...';
                
                // é‡æ–°è¯»å–é…ç½®åˆ·æ–°æ˜¾ç¤º
                const configKeyMap = {
                    'setRouter': 'pancakeRouter',
                    'setPricePair': 'pricePair',
                    'setUsdtToken': 'usdtToken',
                    'setMinibtcToken': 'minibtcToken',
                    'setTokenB': 'tokenB',
                    'setrewardReleaseController': 'ReleaseController',
                    'setOneClickLP': 'oneClickLP',
                    'setAMMAddress': 'ammAddress',
                    'setMachineActivationPercent': 'machineActivationPercent',
                    'setMaxStakePercentPerMachine': 'maxStakePercentPerMachine',
                    'setM': 'minOut'
                };
                if (configKeyMap[funcName]) {
                    setTimeout(() => readLPFarmConfig(configKeyMap[funcName]), 1000);
                }
            } catch (error) {
                let errorMsg = error.message;
                if (errorMsg.includes('only owner')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šä»…åˆçº¦æ‹¥æœ‰è€…å¯è°ƒç”¨è¯¥å‡½æ•°';
                } else if (errorMsg.includes('invalid address')) {
                    errorMsg = 'æ‰§è¡Œå¤±è´¥ï¼šæ— æ•ˆçš„åœ°å€æ ¼å¼';
                } else if (errorMsg.length > 100) {
                    errorMsg = errorMsg.substring(0, 100) + '...';
                }
                
                statusEl.className = 'status error';
                statusEl.textContent = `æ‰§è¡Œå¤±è´¥: ${errorMsg}`;
                console.error('LPFarmæ‰§è¡Œé”™è¯¯:', error);
            }
        }

        // é¡µé¢åˆå§‹åŒ–ï¼šé»˜è®¤å±•å¼€æ‰€æœ‰é¢æ¿
        window.onload = function() {
            document.querySelectorAll('.collapse-content').forEach(el => {
                el.style.display = 'block';
            });
            document.querySelectorAll('.collapse-btn').forEach(btn => {
                btn.textContent = 'æ”¶èµ· â–²';
            });
        };
    </script>
